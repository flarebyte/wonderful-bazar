init = require("fb-custom-init")
flash = require("frozen-flash")
request = require("request")

###
======== A Handy Little Mocha Reference ========
https://github.com/visionmedia/should.js
https://github.com/visionmedia/mocha

###

describe 'frozen-flash', ()->
  describe '#httpGetStageProjectUrl()', ()->

    it 'gets an existing stage url', ()->
      flash.httpGetStageProjectUrl (
        "ah9n7jecnsi2cbpo"
        "biz-flarebyte"
        "t1es8wjsoqbp2b5p"
        "pjt-8280537"
        "fe3l.com"
        (statusCode, json) ->
          statusCode.should.eql(200)
          json.should.be.a('object')
          json.renderer.url.should.eql("fe3l.com")
        )

    it 'does not get an incorrect stage url and should return 403', ()->
      flash.httpGetStageProjectUrl (
        "ah9n7jecnsi2cbpo"
        "biz-xxxxxx"
        "t1es8wjsoqbp2b5p"
        "pjt-8280537"
        "fe3l.com"
        (statusCode, json) ->
          statusCode.should.eql(403)
        )

    it 'gets fe3l.com json with no compression', ()->
      url = "http://ieflashflarebyte.s3.amazonaws.com/icy/"+
      "yg3xgk57l4jizb81ld6wnqef/no/starcom/stage/tree/"+
      "ah9n7jecnsi2cbpo/biz-flarebyte/t1es8wjsoqbp2b5p/"+
      "pjt-8280537/url/fe3l.com/page.json"
      flash.httpGetJson url, (statusCode, json) ->
        statusCode.should.eql(200)
        json.should.be.a('object')
        json.renderer.url.should.eql("fe3l.com")

    it 'gets the stage.flarebyte.com page', ()->
      flash.httpGetStageUrl "stage.flarebyte.com", (statusCode, json) ->
        statusCode.should.eql(200)
        json.should.be.a('object')
        json.renderer.url.should.eql("stage.flarebyte.com")

    it 'gets the fe3l.com live page', ()->
      flash.httpGetLiveUrl "fe3l.com", (statusCode, json) ->
        statusCode.should.eql(200)
        json.should.be.a('object')
        json.renderer.url.should.eql("fe3l.com")

    it 'gets the sle3k.com live page', ()->
      flash.httpGetLiveUrl "sle3k.com", (statusCode, json) ->
        statusCode.should.eql(200)
        json.should.be.a('object')
        json.renderer.url.should.eql("sle3k.com")

