'use strict'
magma_user = require('magma-user')
should = require('should')
CT = require('magma-constant')
_ = require('lodash')
util = require('util')

###
======== A Handy Little Mocha Reference ========
https://github.com/visionmedia/should.js
https://github.com/visionmedia/mocha
###

validUser =
  additionalName:   "Pierre"
  addressCountry:   "gb"
  addressLocality:  "london"
  contactType:      "business"
  familyName:       "Baudelaire"
  #gateId:           CT.EX_GATE_ID
  gender:           CT.GENDER_MALE
  givenName:        "Charles"
  honorificPrefix:  "Mr"
  honorificSuffix:  "Phd"
  id:               CT.EX_USER_ID
  jobTitle:         "Software engineer"
  languages:        "en"
  organization:     "Flarebyte.com"
  organizationUnit: "creative unit"
  profileRef:       CT.EX_EMAIL_U1
  roles:            [CT.EX_ROLE_ID]
  skills:           []
  summary:          "special summary"
  websites:         ["http://flarebyte.com","http://flarebyte.com/b"]
  yearOfBirth:      "1921"

validUser1 = _.cloneDeep(validUser)
validUser1.profileRef= CT.EX_EMAIL_U1
validUser1.givenName= "Charles"

validUser2 = _.cloneDeep(validUser)
validUser2.profileRef= CT.EX_EMAIL_U2
validUser2.givenName= "CharlesII"

validUser3 = _.cloneDeep(validUser)
validUser3.profileRef= CT.EX_EMAIL_U3
validUser3.givenName= "CharlesIII"

myself=
  ownerRef:         CT.EX_OWNER_U1
  gateId:           CT.EX_GATE_ID
  ownerRefs:        [CT.EX_OWNER_U1,CT.EX_OWNER_U2]

userCtx=
  my: myself


describe "magma-user", ->

  describe 'pkGenerator()', ()->
    it 'generate id', ()->
      v= magma_user.pkGenerator(userCtx, validUser)
      v.should.be.eql(
        'magma:f/user/123456789/'+
        '059315e79a4f75dba659e45aec49d4f2bcbf15dfb9efcf9e17aea950133c602c')
