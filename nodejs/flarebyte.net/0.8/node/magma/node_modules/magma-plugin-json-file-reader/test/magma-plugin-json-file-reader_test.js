// Generated by CoffeeScript 1.7.1
(function() {
  'use strict';
  var CT, ctxWithPath, ctxWithStore, init, magma_plugin_json_file_reader, pluginEx, pluginExStore, should, _;

  init = require("fb-custom-init");

  magma_plugin_json_file_reader = require('magma-plugin-json-file-reader');

  should = require('should');

  CT = require('magma-constant');

  _ = require('lodash');


  /*
  ======== A Handy Little Mocha Reference ========
  https://github.com/visionmedia/should.js
  https://github.com/visionmedia/mocha
   */

  pluginEx = {
    pluginId: magma_plugin_json_file_reader.PLUGIN_ID,
    options: {
      folder: "test/andesite",
      input: {
        param: "p1"
      },
      output: {
        key: "results"
      }
    }
  };

  pluginExStore = {
    pluginId: magma_plugin_json_file_reader.PLUGIN_ID,
    options: {
      folder: "test/andesite",
      input: {
        param: "p1"
      },
      output: {
        key: "alpha"
      }
    }
  };

  ctxWithPath = {
    req: {
      query: {
        p1: "ctx_u1"
      }
    },
    content: {
      results: [],
      store: {}
    }
  };

  ctxWithStore = {
    req: {
      query: {
        p1: "ctx_u1"
      }
    },
    content: {
      results: [],
      store: {}
    }
  };

  describe('magma-plugin-json-file-reader', function() {
    return describe('#validatePlugin()', function() {
      return it('validated plugin', function(done) {
        return magma_plugin_json_file_reader.validatePlugin(pluginEx, function(e, res) {
          if (e) {
            return done(e);
          } else {
            res.should.be.ok;
            return done();
          }
        });
      });
    });
  });

  describe('#process()', function() {
    it('populates results', function(done) {
      return magma_plugin_json_file_reader.process(pluginEx.options, ctxWithPath, function(e, res) {
        var expected;
        if (e) {
          return done(e);
        } else {
          expected = "magma:f/gate/773779160";
          res.content.results[0].gateId.should.eql(expected);
          return done();
        }
      });
    });
    return it('populates the store', function(done) {
      return magma_plugin_json_file_reader.process(pluginExStore.options, ctxWithStore, function(e, res) {
        var expected;
        if (e) {
          return done(e);
        } else {
          expected = "magma:f/gate/773779160";
          res.content.store.alpha.gateId.should.eql(expected);
          return done();
        }
      });
    });
  });

}).call(this);

//# sourceMappingURL=magma-plugin-json-file-reader_test.map
